name: build-linux
on: [push]
#  schedule:
#    - cron: '0 0 * * *'
jobs:
  build-linux:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v2
    - name: Build i386 binaries
      run: |
        mkdir /tmp/i386
        cd linux-build
        docker build -t sdl2-i386 -f Dockerfile.i386 .
        docker run -v `pwd`/compile:/entry -v /tmp/i386:/io sdl2-i386
        cp /tmp/i386/lib/libSDL2-2.0.so.0 ../native/linux-x86
    - name: Build amd64 binaries
      run: |
        mkdir /tmp/amd64
        cd linux-build
        docker build -t sdl2-amd64 -f Dockerfile.amd64 .
        docker run -v `pwd`/compile:/entry -v /tmp/amd64:/io sdl2-amd64
        cp /tmp/amd64/lib/libSDL2-2.0.so.0 ../native/linux-x64
    - name: Create pull request
      uses: peter-evans/create-pull-request@v2
      with:
        commit-message: 'Update Linux SDL binaries'
        body: This PR has been auto-generated to update the Linux SDL binaries.
        branch: update-linux-binaries

